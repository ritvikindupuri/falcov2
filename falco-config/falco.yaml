# Falco configuration file

# Whether to output events in json or text
json_output: true

# The following allows to customize the output of the message
json_include_output_property: true
json_include_tags_property: true

# Send events to Falcosidekick
program_output:
  enabled: true
  keep_alive: true
  program: "curl -d @- falcosidekick:2801"

# Web server configuration
webserver:
  enabled: true
  listen_port: 8765
  k8s_healthz_endpoint: /healthz
  ssl_enabled: false

# Enable container metadata collection
load_plugins:
  - name: json
    library_path: libjson.so

# Container engines configuration
container_engines:
  docker:
    enabled: true
  cri:
    enabled: true
    sockets:
      - "/run/containerd/containerd.sock"
    disable_async: false

# Metadata download configuration
metadata_download:
  max_mb: 4
  chunk_wait: 30
  max_connections: 4
  pull_max_retry: 4
  retry_http_codes: [408, 429, 500, 502, 503, 504]
  retry_interval: 2
  timeout: 2000

# Logging configuration
log_level: info
log_stderr: true
log_syslog: false

# Outputs configuration
outputs:
  - console: true
  - file:
      enabled: true
      keep_alive: false
      filename: /var/log/falco_events.log
